<!DOCTYPE html>
<html>
<head>
    <title>Fleming Fantasy Parley Submission</title>
    <style>
        body {
            background-color: white;
            color: red;
        }
        table {
            width: 40%;
            border-collapse: collapse;
            margin-left: 0;
        }
        th, td {
            border: 1px solid white;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: white;
        }
    </style>
</head>
<body>
    <h1>Fleming Fantasy Parley Submission</h1>
    <p><strong>Instructions:</strong> First enter Odds, then the Bet Name. Once your bet is set for the week, it cannot be changed. Do not click 'Reset', that is only for Tomas to reset at the end of each week.</p>

    <table>
        <thead>
            <tr>
                <th>User</th>
                <th>Bet</th>
                <th>Odds</th>
            </tr>
        </thead>
        <tbody id="betsContainer"></tbody>
    </table>

    <button type="button" onclick="resetFields()">Reset</button>

    <h2>Results</h2>
    <p id="totalOdds">Total Parley Odds: N/A</p>
    <p id="potentialReturn">Potential Return: N/A</p>
    <p id="roi">ROI: N/A</p>

    <script>
        const users = ["Tomas", "Harrison", "Mojo", "Chris", "Patric", "Daniel", "Chatt", "DK", "Nick", "Parth", "Sandia", "Dylan", "Rush", "Alec"];

        // Dynamically generate input fields for each user
        const betsContainer = document.getElementById('betsContainer');
        users.forEach(user => {
            betsContainer.innerHTML += `
                <tr>
                    <td>${user}</td>
                    <td><input type="text" id="${user.toLowerCase()}_bet" oninput="updateAndLock('${user.toLowerCase()}')"></td>
                    <td><input type="number" id="${user.toLowerCase()}_odds" oninput="updateAndLock('${user.toLowerCase()}')"></td>
                </tr>
            `;
        });

        function convertAmericanToDecimal(americanOdds) {
            return americanOdds > 0 ? (americanOdds / 100) + 1 : (100 / Math.abs(americanOdds)) + 1;
        }

        function calculateParley() {
            let totalOdds = 1, betsEntered = false;

            users.forEach(user => {
                const odds = parseFloat(document.getElementById(`${user.toLowerCase()}_odds`).value);
                if (!isNaN(odds)) {
                    totalOdds *= convertAmericanToDecimal(odds);
                    betsEntered = true;
                }
            });

            if (!betsEntered) {
                document.getElementById('totalOdds').innerText = "Total Parley Odds: N/A";
                document.getElementById('potentialReturn').innerText = "Potential Return: N/A";
                document.getElementById('roi').innerText = "ROI: N/A";
                return;
            }

            const stake = 10, potentialReturn = stake * totalOdds, roi = ((potentialReturn - stake) / stake) * 100;
            document.getElementById('totalOdds').innerText = `Total Parley Odds: ${totalOdds.toFixed(2)}`;
            document.getElementById('potentialReturn').innerText = `Potential Return: $${potentialReturn.toFixed(2)}`;
            document.getElementById('roi').innerText = `ROI: ${roi.toFixed(2)}%`;
        }

        function updateAndLock(user) {
            calculateParley();
            const betField = document.getElementById(`${user}_bet`);
            const oddsField = document.getElementById(`${user}_odds`);

            if (betField.value && oddsField.value) {
                betField.disabled = true;
                oddsField.disabled = true;
                localStorage.setItem(`${user}_bet`, betField.value);
                localStorage.setItem(`${user}_odds`, oddsField.value);
            }
        }

        function resetFields() {
            users.forEach(user => {
                document.getElementById(`${user.toLowerCase()}_bet`).disabled = false;
                document.getElementById(`${user.toLowerCase()}_odds`).disabled = false;
                document.getElementById(`${user.toLowerCase()}_bet`).value = "";
                document.getElementById(`${user.toLowerCase()}_odds`).value = "";
                localStorage.removeItem(`${user.toLowerCase()}_bet`);
                localStorage.removeItem(`${user.toLowerCase()}_odds`);
            });
            document.getElementById('totalOdds').innerText = "Total Parley Odds: N/A";
            document.getElementById('potentialReturn').innerText = "Potential Return: N/A";
            document.getElementById('roi').innerText = "ROI: N/A";
        }

        function restoreFields() {
            users.forEach(user => {
                const betValue = localStorage.getItem(`${user.toLowerCase()}_bet`);
                const oddsValue = localStorage.getItem(`${user.toLowerCase()}_odds`);
                if (betValue && oddsValue) {
                    document.getElementById(`${user.toLowerCase()}_bet`).value = betValue;
                    document.getElementById(`${user.toLowerCase()}_odds`).value = oddsValue;
                    document.getElementById(`${user.toLowerCase()}_bet`).disabled = true;
                    document.getElementById(`${user.toLowerCase()}_odds`).disabled = true;
                }
            });
        }

        window.onload = restoreFields;
    </script>
</body>
</html>
